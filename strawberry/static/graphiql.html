<!DOCTYPE html>
<html>
  <head>
    <title>Strawberry GraphiQL</title>
    <link
      rel="icon"
      href="data:image/svg+xml,
        <svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22>
            <!-- Strawberry Emoji as a HTML Entity (hex)  -->
            <text y=%22.9em%22 font-size=%2280%22>&#x1f353;</text>
        </svg>"
    />
    <style>
      body {
        height: 100%;
        margin: 0;
        width: 100%;
        overflow: hidden;
      }

      #graphiql {
        height: 100vh;
        display: flex;
      }
    </style>

    <script
      crossorigin
      src="https://unpkg.com/react@17.0.2/umd/react.development.js"
      integrity="sha384-xQwCoNcK/7P3Lpv50IZSEbJdpqbToWEODAUyI/RECaRXmOE2apWt7htari8kvKa/"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@17.0.2/umd/react-dom.development.js"
      integrity="sha384-E9IgxDsnjKgh0777N3lXen7NwXeTsOpLLJhI01SW7idG046SRqJpsW2rJwsOYk0L"
    ></script>

    <script
      crossorigin
      src="https://unpkg.com/js-cookie@3.0.1/dist/js.cookie.min.js"
      integrity="sha384-ETDm/j6COkRSUfVFsGNM5WYE4WjyRgfDhy4Pf4Fsc8eNw/eYEMqYZWuxTzMX6FBa"
    ></script>

    <link
      crossorigin
      rel="stylesheet"
      href="https://unpkg.com/graphiql@2.0.1/graphiql.min.css"
      integrity="sha384-l6I62amvSHSq3QYl/1z8lK51hxXykDo595FptSokl33ij9LzXYXcBG4gLb3jzt6n"
    />

    <style>
      body {
        margin: 0;
      }

      #root {
        height: 100vh;
      }

      .docExplorerWrap {
        height: unset !important;
        min-width: unset !important;
        width: unset !important;
      }

      .doc-explorer-title {
        font-size: var(--font-size-h2);
        font-weight: var(--font-weight-medium);
      }

      .doc-explorer-rhs {
        display: none;
      }

      .graphiql-explorer-root {
        font-family: var(--font-family-mono) !important;
        font-size: var(--font-size-body) !important;
        padding: 0 !important;
      }

      .graphiql-explorer-root > div:first-child {
        padding-left: var(--px-8);
      }

      .graphiql-explorer-root input {
        background: hsl(var(--color-base));
      }

      .graphiql-explorer-root select {
        background-color: hsl(var(--color-base));
        border: 1px solid hsla(var(--color-neutral), 0.6);
        border-radius: var(--border-radius-4);
        color: hsl(var(--color-neutral));
        margin: 0 var(--px-4);
        padding: var(--px-4) var(--px-6);
      }
    </style>
  </head>

  <body>
    <div id="graphiql" class="graphiql-container">Loading...</div>
    <script
      crossorigin
      src="https://unpkg.com/graphiql@2.0.1/graphiql.min.js"
      integrity="sha384-FWntKqUbOayK9JbjeZiU5y5iZezCuLAKmS+rLTpKJ085FtWngWH0CJEDm+VGnXEq"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/graphiql-explorer@0.9.0/graphiqlExplorer.min.js"
      integrity="sha384-dqjSDjPNodMPApJUq6VHzhvESfqZTPen8+6oVAkR3AQO3P3CnujJRDODn9bWPszg"
    ></script>
    <script>
      const fetchURL = window.location.href;

      function httpUrlToWebSockeUrl(url) {
        return url.replace(/(http)(s)?\:\/\//, "ws$2://");
      }

      const headers = {
        Accept: "application/json",
        "Content-Type": "application/json",
      };

      const csrfToken = Cookies.get("csrftoken");
      if (csrfToken) {
        headers["x-csrftoken"] = csrfToken;
      }

      const subscriptionsEnabled = JSON.parse("false");
      const subscriptionUrl = subscriptionsEnabled
        ? httpUrlToWebSockeUrl(fetchURL)
        : null;
      function graphQLFetcher(graphQLParams) {
        return fetch(
          "https://swapi-graphql.netlify.app/.netlify/functions/index",
          {
            method: "post",
            headers: {
              Accept: "application/json",
              "Content-Type": "application/json",
            },
            body: JSON.stringify(graphQLParams),
            credentials: "omit",
          }
        ).then(function (response) {
          return response.json().catch(function () {
            return response.text();
          });
        });
      }

      const QueryContext = React.createContext({
        query: "",
        setQuery: () => {},
      });

      function ExplorerPlugin() {
        const { setOperationName } = GraphiQL.useEditorContext({
          nonNull: true,
        });
        const { schema } = GraphiQL.useSchemaContext({ nonNull: true });
        const { run } = GraphiQL.useExecutionContext({ nonNull: true });

        const { query, setQuery } = React.useContext(QueryContext);

        const arrowOpen = React.createElement(
          "svg",
          {
            viewBox: "0 -4 13 15",
            style: {
              color: "hsla(var(--color-neutral), 0.4)",
              marginRight: "var(--px-4)",
              height: "var(--px-16)",
              width: "var(--px-16)",
            },
          },
          React.createElement("path", {
            d: "M3.35355 6.85355L6.14645 9.64645C6.34171 9.84171 6.65829 9.84171 6.85355 9.64645L9.64645 6.85355C9.96143 6.53857 9.73835 6 9.29289 6L3.70711 6C3.26165 6 3.03857 6.53857 3.35355 6.85355Z",
            fill: "currentColor",
          })
        );

        const arrowClosed = React.createElement(
          "svg",
          {
            viewBox: "0 -2 13 15",
            style: {
              color: "hsla(var(--color-neutral), 0.4)",
              marginRight: "var(--px-4)",
              height: "var(--px-16)",
              width: "var(--px-16)",
            },
          },
          React.createElement("path", {
            d: "M6.35355 11.1464L9.14645 8.35355C9.34171 8.15829 9.34171 7.84171 9.14645 7.64645L6.35355 4.85355C6.03857 4.53857 5.5 4.76165 5.5 5.20711V10.7929C5.5 11.2383 6.03857 11.4614 6.35355 11.1464Z",
            fill: "currentColor",
          })
        );
        const checkboxUnchecked = React.createElement(
          "svg",
          {
            viewBox: "0 0 15 15",
            style: {
              color: "hsla(var(--color-neutral), 0.4)",
              marginRight: "var(--px-4)",
              height: "var(--px-16)",
              width: "var(--px-16)",
            },
          },
          React.createElement("circle", {
            cx: "7.5",
            cy: "7.5",
            r: "6",
            stroke: "currentColor",
            fill: "none",
          })
        );

        const checkboxChecked = React.createElement(
          "svg",
          {
            viewBox: "0 0 15 15",
            style: {
              color: "hsl(var(--color-info))",
              marginRight: "var(--px-4)",
              height: "var(--px-16)",
              width: "var(--px-16)",
            },
          },
          React.createElement("circle", {
            cx: "7.5",
            cy: "7.5",
            r: "7.5",
            fill: "currentColor",
          }),
          React.createElement("path", {
            d: "M4.64641 7.00106L6.8801 9.23256L10.5017 5.61325",
            fill: "none",
            stroke: "white",
            strokeWidth: "1.5",
          })
        );

        return React.createElement(GraphiQLExplorer.Explorer, {
          schema,
          query,
          explorerIsOpen: true,
          onEdit: (newQuery) => setQuery(newQuery),
          onRunOperation: (operationName) => {
            if (operationName) {
              setOperationName(operationName);
            }
            run();
          },
          arrowOpen,
          arrowClosed,
          checkboxUnchecked,
          checkboxChecked,
          colors: {
            keyword: "hsl(var(--color-primary))",
            def: "hsl(var(--color-tertiary))",
            property: "hsl(var(--color-info))",
            qualifier: "hsl(var(--color-secondary))",
            attribute: "hsl(var(--color-info))",
            number: "hsl(var(--color-success))",
            string: "hsl(var(--color-warning))",
            builtin: "hsl(var(--color-success))",
            string2: "hsl(var(--color-secondary))",
            variable: "hsl(var(--color-secondary))",
            atom: "hsl(var(--color-tertiary))",
            meta: "hsl(var(--color-tertiary))",
          },
          styles: {
            buttonStyle: {
              backgroundColor: "transparent",
              border: "none",
              color: "hsla(var(--color-neutral), 0.6)",
              cursor: "pointer",
              fontSize: "1em",
            },
            explorerActionsStyle: {
              padding: "var(--px-8) var(--px-4)",
            },
            actionButtonStyle: {
              backgroundColor: "transparent",
              border: "none",
              color: "hsla(var(--color-neutral), 0.6)",
              cursor: "pointer",
              fontSize: "1em",
            },
          },
        });
      }

      const explorerPlugin = {
        title: "GraphiQL Explorer",
        icon: () =>
          React.createElement(
            "svg",
            {
              height: "1em",
              strokeWidth: "1.5",
              viewBox: "0 0 24 24",
              fill: "none",
            },
            React.createElement("path", {
              d: "M18 6H20M22 6H20M20 6V4M20 6V8",
              stroke: "currentColor",
              strokeLinecap: "round",
              strokeLinejoin: "round",
            }),
            React.createElement("path", {
              d: "M21.4 20H2.6C2.26863 20 2 19.7314 2 19.4V11H21.4C21.7314 11 22 11.2686 22 11.6V19.4C22 19.7314 21.7314 20 21.4 20Z",
              stroke: "currentColor",
              strokeLinecap: "round",
              strokeLinejoin: "round",
            }),
            React.createElement("path", {
              d: "M2 11V4.6C2 4.26863 2.26863 4 2.6 4H8.77805C8.92127 4 9.05977 4.05124 9.16852 4.14445L12.3315 6.85555C12.4402 6.94876 12.5787 7 12.722 7H14",
              stroke: "currentColor",
              strokeLinecap: "round",
              strokeLinejoin: "round",
            })
          ),
        content: () => React.createElement(ExplorerPlugin),
      };

      function App() {
        const [query, setQuery] = React.useState("{}");

        return React.createElement(
          QueryContext.Provider,
          {
            value: React.useMemo(() => ({ query, setQuery }), [query]),
          },

          React.createElement(GraphiQL, {
            fetcher: graphQLFetcher,
            query: query,
            onEditQuery: (newQuery) => setQuery(newQuery),
            defaultVariableEditorOpen: true,
            plugins: [explorerPlugin],
          })
        );
      }

      ReactDOM.render(
        React.createElement(App),
        document.getElementById("graphiql")
      );
    </script>
  </body>
</html>
